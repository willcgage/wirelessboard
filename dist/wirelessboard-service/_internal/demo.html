<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="mobile-web-app-capable" content="yes" />
    <link rel="shortcut icon" type="image/png" href="static/favicon.png">
    <link rel="apple-touch-icon" href="static/logo.png">

    <!-- https://medium.com/appscope/designing-native-like-progressive-web-apps-for-ios-1b3cdda1d0e8 -->
    <!-- iPhone 8 Plus, 7 Plus, 6s Plus, 6 Plus (1242px x 2208px) -->
    <link rel="apple-touch-startup-image" href="static/splash/iPad-Pro-12.9-portrait-1668x2224.png" media="(device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">
    <link rel="apple-touch-startup-image" href="static/splash/iPad-Pro-12.9-landscape-2224x1668.png" media="(device-width: 1112px) and (device-height: 834px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)">
    <link rel="apple-touch-startup-image" href="static/splash/iPad-Pro-10.5-portrait-2048x2732.png" media="(device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">
    <link rel="apple-touch-startup-image" href="static/splash/iPad-Pro-10.5-landscape-2732x2048.png" media="(device-width: 1366px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)">
    <link rel="apple-touch-startup-image" href="static/splash/iPad-portrait-1536x2048.png" media="(device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">
    <link rel="apple-touch-startup-image" href="static/splash/iPad-landscape-2048x1536.png" media="(device-width: 1024px) and (device-height: 768px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)">
    <link rel="apple-touch-startup-image" href="static/splash/iPhone-Xs-Max-portrait-1242x2688.png" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)">
    <link rel="apple-touch-startup-image" href="static/splash/iPhone-Xs-Max-landscape-2688x1242.png" media="(device-width: 896px) and (device-height: 414px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)">
    <link rel="apple-touch-startup-image" href="static/splash/iPhone-Xr-portrait-828x1792.png" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">
    <link rel="apple-touch-startup-image" href="static/splash/iPhone-Xr-landscape-1792x828.png" media="(device-width: 896px) and (device-height: 414px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)">
    <link rel="apple-touch-startup-image" href="static/splash/iPhone-X-portrait-1125x2436.png" media="(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)">
    <link rel="apple-touch-startup-image" href="static/splash/iPhone-X-landscape-2436x1125.png" media="(device-width: 812px) and (device-height: 375px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)">
    <link rel="apple-touch-startup-image" href="static/splash/iPhone-Plus-portrait-1242x2208.png" media="(device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)">
    <link rel="apple-touch-startup-image" href="static/splash/iPhone-Plus-landscape-2208x1242.png" media="(device-width: 736px) and (device-height: 414px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)">
    <link rel="apple-touch-startup-image" href="static/splash/iPhone-portrait-750x1334.png" media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">
    <link rel="apple-touch-startup-image" href="static/splash/iPhone-landscape-1334x750.png" media="(device-width: 667px) and (device-height: 375px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)">
    <link rel="apple-touch-startup-image" href="static/splash/iPhone-SE-portrait-640x1136.png" media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">
    <link rel="apple-touch-startup-image" href="static/splash/iPhone-SE-landscape-1136x640.png" media="(device-width: 568px) and (device-height: 320px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)">
    <style>
      /* Hide secondary views immediately to avoid startup flash */
      .settings { display: none; }
      #pco-settings { display: none; }
    </style>
  </head>
  <body>
    <nav class="navbar navbar-expand-lg navbar-light bg-light mb-3">
      <div class="container-fluid">
  <a class="navbar-brand" href="#">Wirelessboard</a>
        <div class="d-flex gap-2">
          <a href="#" id="go-pco" class="btn btn-outline-primary btn-sm">PCO</a>
          <a href="#" id="go-config" class="btn btn-outline-secondary btn-sm">Config</a>
          <a href="#" id="go-hud" class="btn btn-outline-info btn-sm">Help</a>
        </div>
      </div>
    </nav>
  <div id="hud" class="container collapse">
        <div class="row hud-version" data-role="hud-version">
          <div class="col">
            <p id="hud-version-text" class="text-muted small mb-3">Wirelessboard version loading…</p>
          </div>
        </div>
        <div class="row">
          <div class="col-4 keyboard-guide">
            <h2 class="text-center">Keyboard Shortcuts</h2>
            <ul>
              <li><kbd>?</kbd> - Show keyboard shortcuts</li>
              <li><kbd>0</kbd> - Show all slots</li>
              <li><kbd>1</kbd>...<kbd>9</kbd> - Load group</li>
              <li><kbd>d</kbd> - Start demo mode</li>
              <li><kbd>e</kbd> - Open group editor</li>
              <li><kbd>t</kbd> - Toggle TV view</li>
              <li><kbd>i</kbd> - Change tv display mode</li>
              <li><kbd>f</kbd> - Toggle fullscreen</li>
              <li><kbd>g</kbd> - Toggle image backgrounds</li>
              <li><kbd>v</kbd> - Toggle video backgrounds</li>
              <li><kbd>n</kbd> - Extended Name editor</li>
              <li><kbd>s</kbd> - Device configuration editor</li>
              <li><kbd>q</kbd> - Show QR code</li>
              <li><kbd>esc</kbd> - reload wirelessboard</li>
            </ul>
          </div>
        </div>
        <div class="row">
          <div class="col color-guide-color CRITICAL">
            <h3>Critical</h3>
            <p>Mic ON.  1 - 2 Battery Bars.</p>
          </div>
          <div class="col color-guide-color PREV_CRITICAL">
            <h3>Previously Critical</h3>
            <p>Mic OFF.  1 - 2 Battery Bars.</p>
          </div>
        </div>
        <div class="row">
          <div class="col color-guide-color UNASSIGNED">
            <h3>Unknown</h3>
            <p>Wirelessboard doesn’t make battery assumptions once a mic is off for over 30 minutes.</p>
          </div>
        </div>
        <div class="row">
          <div class="col color-guide-color RX_COM_ERROR">
            <h3>RX COM Error</h3>
            <p>Wirelessboard can't connect to the device.</p>
          </div>
          <div class="col color-guide-color AUDIO_PEAK">
            <h3>Audio Peak</h3>
            <p>Input peak.</p>
          </div>
        </div>
        <div class="d-grid gap-2">
          <button id="hud-button" type="button" class="btn btn-success btn-lg" data-bs-toggle="collapse" data-bs-target="#hud">Close</button>
        </div>
      </div>
    <!-- Dedicated PCO settings view (separate page) -->
  <div class="container" id="pco-settings">
      <div class="row">
        <div class="col-xl-12">
          <div class="config-header d-flex justify-content-between align-items-center">
            <button type="button" id="pco-close" class="btn btn-outline-secondary">Close</button>
            <h3 class="text-center flex-grow-1">Planning Center Online</h3>
            <span class="invisible">placeholder</span>
          </div>
          <div class="p-3 border rounded">
            <form id="pco-form" autocomplete="off" novalidate>
              <div class="form-row">
                <div class="col-md-2 col-6">
                  <div class="input-group-text">
                    <input type="checkbox" id="pco-enabled">&nbsp;Enable PCO
                  </div>
                </div>
                <div class="col-md-5 col-12">
                  <input type="text" class="form-control" id="pco-token" name="pco-token" placeholder="PCO Personal Access Token" autocomplete="off">
                </div>
                <div class="col-md-5 col-12">
                  <input type="password" class="form-control" id="pco-secret" name="pco-secret" placeholder="PCO Personal Access Secret" autocomplete="off">
                </div>
              </div>
              <div class="form-row mt-2">
                <div class="col-md-6 col-12">
                  <input type="text" class="form-control" id="pco-note-category" name="pco-note-category" placeholder="Note Category (default: Mic / IEM Assignments)" autocomplete="off">
                </div>
                <div class="col-md-6 col-12 mt-2 mt-md-0">
                  <input type="text" class="form-control" id="pco-team-filter" name="pco-team-filter" placeholder="Team Name Filter (comma-separated)" autocomplete="off">
                </div>
              </div>
              <div class="form-row mt-3">
                <div class="col">
                  <button type="submit" id="pco-save" class="btn btn-primary mr-2">Save PCO Settings</button>
                  <button type="button" id="pco-sync" class="btn btn-secondary">Sync Now</button>
                </div>
              </div>
              <div class="form-row mt-2">
                <div class="col">
                  <div id="pco-save-status" class="alert alert-success d-none" role="alert">
                    PCO settings saved.
                  </div>
                </div>
              </div>
            </form>
          </div>
        </div>
      </div>
    <!-- ...existing code for single PCO settings view... -->
      <div class="row mt-3">
        <div class="col-xl-12">
          <div class="p-3 border rounded">
            <div class="row g-2 align-items-end">
              <div class="col-md-10 col-12">
                <label for="pco-plan-select" class="form-label">Plan</label>
                <div class="d-flex gap-2">
                  <select class="form-select" id="pco-plan-select">
                    <option value="">Select a plan…</option>
                  </select>
                  <button type="button" id="pco-refresh-plans" class="btn btn-outline-secondary">Refresh Plans</button>
                </div>
              </div>
              <div class="col-md-2 col-12 d-grid gap-2">
                <button type="button" id="pco-load-people" class="btn btn-outline-primary" disabled>Load People</button>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="row mt-4">
        <div class="col-xl-12">
          <div class="config-header">
            <h4 class="text-center">PCO People (Selected Plan)</h4>
          </div>
          <div class="p-3 border rounded">
            <div id="pco-people-summary" class="mb-2"></div>
            <div class="table-responsive" id="pco-people-table" style="display:none;">
              <table class="table table-sm table-striped">
                <thead>
                  <tr><th>Name</th><th>Team</th><th>Note</th></tr>
                </thead>
                <tbody></tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
      <div class="row mt-4">
        <div class="col-xl-12">
          <div class="config-header">
            <h4 class="text-center">Assign People to Slots</h4>
          </div>
          <div class="p-3 border rounded">
            <div id="pco-assign-summary" class="mb-2"></div>
            <div class="table-responsive" id="pco-assign-table" style="display:none;">
              <table class="table table-sm table-striped">
                <thead>
                  <tr><th>Slot</th><th>Device</th><th>Device Name</th><th>Extended Name</th><th>Select Person</th></tr>
                </thead>
                <tbody></tbody>
              </table>
            </div>
            <div class="d-flex gap-2 mt-2">
              <button type="button" id="pco-autofill-assignments" class="btn btn-success">Auto-Fill From Notes</button>
              <button type="button" id="pco-apply-assignments" class="btn btn-primary">Apply Assignments</button>
              <button type="button" id="pco-clear-assignment-selects" class="btn btn-outline-secondary">Clear Selections</button>
            </div>
          </div>
        </div>
      </div>
      <div class="row mt-4">
        <div class="col-xl-12">
          <div class="config-header">
            <h4 class="text-center">PCO API Log</h4>
          </div>
          <div class="p-3 border rounded">
            <div id="pco-log-entries" class="bg-dark text-light small rounded p-2 mb-3"></div>
            <div id="pco-sync-summary" class="mb-2"></div>
            <div class="table-responsive" id="pco-assignments-table" style="display:none;">
              <table class="table table-sm table-striped">
                <thead>
                  <tr><th>ID</th><th>Name</th></tr>
                </thead>
                <tbody></tbody>
              </table>
            </div>
            <pre id="pco-sync-json" class="bg-light p-2" style="max-height: 300px; overflow: auto;"></pre>
          </div>
        </div>
      </div>
    </div>
    <div class="container-fluid fullHeight deskmode" id="container">

      <div id="qr-modal" class="modal fade bd-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-centered">
          <div class="modal-content">
            <div class="qr text-center">
              <p id="wirelessboard-version"></p>
              <p><a id="largelink" href=""></a></p>
              <canvas id="qrcode"></canvas>
            </div>
          </div>
        </div>
      </div>


      <div class="sidebar-nav">
        <h1 id='sidebarTitle'>Group 4</h1>
        <div class="slot-prototype-list drag-container" id="eslotlist">

        </div>
        <div class="form-group">
          <input type="text" class="form-control" id="groupTitle" placeholder="title">
          <div class="input-group">
            <div class="input-group-prepend">
              <span class="input-group-text">Hide inactive charts</span>
            </div>

            <div class="input-group-text">
            </div>
          </div>
          <div class="d-grid gap-1">
            <button type="button" class="btn btn-success btn-lg" id="editorSave">Save</button>
            <button type="button" class="btn btn-warning btn-lg" id="editorClose">Close</button>
            <button type="button" class="btn btn-danger btn-lg" id="editorClear">Clear</button>
          </div>
        </div>
      </div>
  <div id="micboard" class="row above-mid bg-std elinfo11 drag-container wirelessboard-board">

      </div>

      <div class="above-mid message-board">
        <h1>Connection Error!</h1>
  <p>Could not connect to the wirelessboard server. Please refresh the page.</p>
      </div>
      <div class="settings">

        <div class="row">

          <div class="col-xl-6" id="cfg-discovered-col">
            <div class="config-header">
              <h3 class="text-center">Discovered Devices</h3>
            </div>

            <div id="discovered_list"></div>
            <div class="config-footer">
              <div class="row">

                <div class="col d-grid gap-2">
                  <button id="add-discovered" class="btn btn-danger">Add All Discovered Devices</button>
                </div>

              </div>
            </div>
          </div>

          <div class="col-xl-6" id="cfg-slot-col">
            <div class="config-header">
              <h3 class="text-center">Slot Configuration</h3>
            </div>
            <div id="editor_holder"></div>
            <div class="config-footer">
              <div class="row">

                      </div>

                      <div class="row">
                        <div class="col d-grid gap-2">
                          <button type="button" class="btn btn-secondary btn-warning" id="clear-id">Clear IDs</button>
                        </div>
                        <div class="col d-grid gap-2">
                          <button type="button" class="btn btn-secondary btn-warning" id="clear-name">Clear Extended Names</button>
                        </div>
                      </div>
                      <div class="row mt-2">
                        <div class="col d-grid gap-2">
                          <button type="button" class="btn btn-secondary" id="clear-device-names">Clear Device Names</button>
                        </div>
                        <div class="col d-grid gap-2">
                          <button type="button" class="btn btn-outline-info" id="read-device-names">Read Device Names</button>
                        </div>
                      </div>
                      <div class="row mt-2">
                        <div class="col">
                          <div id="device-name-status" class="small text-muted d-none"></div>
                        </div>
                      </div>
                      <div class="row mt-2">
                        <div class="col d-grid gap-2">
                          <button type="button" class="btn btn-outline-primary" id="add-config-row">Add Row</button>
                        </div>
                        <div class="col d-grid gap-2">
                          <button type="button" class="btn btn-outline-secondary" id="clear-config">Clear All</button>
                        </div>
                        <div class="col d-grid gap-2">
                          <button type="button" class="btn btn-success" id="save">Save Config</button>
                        </div>
                      </div>
                    </div>

        </div>
        <!-- <div class="text-muted text-center">Micboard</div> -->
      
    </div>
  <template id="column-template">
      <div class="col-sm">
        <div class="mic_name">
          <div class="slot-media" aria-hidden="true"></div>
          <p class="mic_id"></p>
          <p class="name"></p>
          <p class="ext-name"></p>
        </div>
        <div class="electrode"></div>

  <div class="info-drawer">
          <div class="battery-bars">
            <div class="battery-bar battery-bar-1"></div>
            <div class="battery-bar battery-bar-2"></div>
            <div class="battery-bar battery-bar-3"></div>
            <div class="battery-bar battery-bar-4"></div>
            <div class="battery-bar battery-bar-5"></div>
          </div>
          <div class="chartzone">
            <p class="runtime"></p>
            <p class="offset"></p>
            <canvas class="slotgraph"></canvas>
            <p class="powerlock">
              <svg class="bi lock-fill" width="1.5em" height="1.5em" viewBox="0 0 20 20" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                <rect width="11" height="9" x="4.5" y="8" rx="2"/>
                <path fill-rule="evenodd" d="M6.5 5a3.5 3.5 0 117 0v3h-1V5a2.5 2.5 0 00-5 0v3h-1V5z" clip-rule="evenodd"/>
                <!-- <path fill-rule="evenodd" d="M13.655 9H6.333c-.264 0-.398.068-.471.121a.73.73 0 00-.224.296 1.626 1.626 0 00-.138.59V15c0 .342.076.531.14.635.064.106.151.18.256.237a1.122 1.122 0 00.436.127l.013.001h7.322c.264 0 .398-.068.471-.121a.73.73 0 00.224-.296 1.627 1.627 0 00.138-.59V10c0-.342-.076-.531-.14-.635a.658.658 0 00-.255-.237 1.123 1.123 0 00-.45-.128zm.012-1H6.333C4.5 8 4.5 10 4.5 10v5c0 2 1.833 2 1.833 2h7.334c1.833 0 1.833-2 1.833-2v-5c0-2-1.833-2-1.833-2zM6.5 5a3.5 3.5 0 117 0v3h-1V5a2.5 2.5 0 00-5 0v3h-1V5z" clip-rule="evenodd"/> -->
              </svg>
            </p>
            <p class="quality"></p>
            <p class="frequency"></p>
          </div>

          <div class="errorzone">
            <p class="errortype">RX COM Error</p>
            <p class="ip"></p>
            <p class="rxinfo"></p>
          </div>

          <div class="editzone">
            <div class="row">
              <div class="col">
                <input type="text" class="form-control ext-id" aria-label="Default" aria-describedby="inputGroup-sizing-default" autocomplete="off" placeholder="ID">
              </div>
              <div class="col">
                <input type="text" class="form-control ext-name" aria-label="Default" aria-describedby="inputGroup-sizing-default" autocomplete="off" placeholder="Name">
              </div>
            </div>
          </div>

          <div class="diversity">
            <div class="diversity-bar"></div>
            <div class="diversity-bar"></div>
          </div>
        </div>
      </div>
    </template>

    <template id="save-template">
      <div class="col-sm" id="paste-box">
        <div class="row">
          <div class="col">
            <textarea class="form-control" id="bulkbox" rows="3"></textarea>
          </div>
        </div>
        <div class="row">
          <div class="col d-grid gap-2">
            <button type="button" class="btn btn-success" id="bulk-name-loader">Load Bulk Names</button>
          </div>
        </div>
      </div>
      <div class="col-sm" id="save-box">
        <div class="row">
          <div class="col d-grid gap-2">
            <button type="button" class="btn btn-success" id="slotSave">Save</button>
          </div>
        </div>

        <div class="row">
          <div class="col d-grid gap-2">
            <button type="button" class="btn btn-secondary btn-warning" id="clear-id">Clear IDs</button>
          </div>
          <div class="col d-grid gap-2">
            <button type="button" class="btn btn-secondary btn-warning" id="clear-name">Clear Extended Names</button>
          </div>
        </div>
      </div>
    </template>

    <template id="config-slot-template">
      <div class="row cfg-row">
        <div class="col col-md-1 col-4 slot-number text-center cfg-row-form">
          <label class="col-form-label"></label>
        </div>

        <div class="col col-md-3 col-12 cfg-row-form">
          <label class="form-label text-light small">IP</label>
          <input type="text" class="form-control cfg-ip" placeholder="e.g. 192.168.1.50">
        </div>

        <div class="col col-md-2 col-6 cfg-row-form">
          <label class="form-label text-light small">Type</label>
          <select class="form-control cfg-type">
            <option value=""></option>
            <option>axtd</option>
            <option>ulxd</option>
            <option>qlxd</option>
            <option>uhfr</option>
            <option>p10t</option>
            <option>offline</option>
          </select>
        </div>

        <div class="col col-md-2 col-6 cfg-row-form">
          <label class="form-label text-light small">Channel</label>
          <select class="form-control cfg-channel">
            <option>1</option>
            <option>2</option>
            <option>3</option>
            <option>4</option>
          </select>
        </div>

        <div class="col col-md-3 col-12 cfg-row-form">
          <label class="form-label text-light small">Device Name</label>
          <input type="text" class="form-control cfg-device-name" placeholder="Detected device name" readonly tabindex="-1">
          <label class="form-label text-light small mt-2">Extended Name</label>
          <input type="text" class="form-control cfg-name" placeholder="Extended name (used by PCO)">
        </div>

        <div class="col col-md-1 col-12 del-btn cfg-row-form d-grid gap-2">
          <label class="form-label d-none d-md-block">&nbsp;</label>
          <button type="button" class="btn float-right btn-danger"><span aria-hidden="true">&times;</span></button>
        </div>

      </div>
    </template>
    <script src="static/app.js"></script>
  </body>
</html>
